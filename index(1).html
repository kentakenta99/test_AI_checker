<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AIä½¿ã£ã¦ã„ã„ï¼Ÿ 3ã¤ã®è³ªå•ã§åˆ¤æ–­</title>
<style>
  :root {
    --bg: #0a0f1e;
    --surface: #111827;
    --surface2: #1a2235;
    --border: #1e2d45;
    --text: #e8edf5;
    --text-dim: #7a8ba3;
    --accent: #3b82f6;
    --accent2: #06b6d4;
    --green: #10b981;
    --green-bg: #052e1c;
    --green-border: #065f46;
    --yellow: #f59e0b;
    --yellow-bg: #2d1c00;
    --yellow-border: #78350f;
    --red: #ef4444;
    --red-bg: #2d0a0a;
    --red-border: #7f1d1d;
    --radius: 16px;
    --radius-sm: 8px;
    --mono: 'Courier New', Courier, monospace;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'BIZ UDPGothic', Meiryo, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background grid */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(59,130,246,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(59,130,246,0.03) 1px, transparent 1px);
    background-size: 48px 48px;
    pointer-events: none;
    z-index: 0;
  }

  header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(10,15,30,0.92);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 16px 20px;
  }

  .header-inner {
    max-width: 720px;
    margin: 0 auto;
  }

  .header-title {
    font-size: 18px;
    font-weight: 900;
    letter-spacing: -0.5px;
    background: linear-gradient(135deg, #60a5fa, #06b6d4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 6px;
  }

  .north-star {
    font-size: 11px;
    color: var(--text-dim);
    line-height: 1.6;
    border-left: 2px solid var(--accent);
    padding-left: 10px;
  }

  main {
    max-width: 720px;
    margin: 0 auto;
    padding: 24px 16px 80px;
    position: relative;
    z-index: 1;
  }

  /* Progress */
  .progress-wrap {
    margin-bottom: 24px;
  }

  .progress-labels {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    color: var(--text-dim);
    font-family: var(--mono);
    margin-bottom: 8px;
  }

  .progress-bar-outer {
    height: 4px;
    background: var(--surface2);
    border-radius: 99px;
    overflow: hidden;
  }

  .progress-bar-inner {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    border-radius: 99px;
    transition: width 0.4s cubic-bezier(0.4,0,0.2,1);
  }

  /* Step */
  .step {
    display: none;
    animation: fadeUp 0.3s ease both;
  }

  .step.active { display: block; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .step-label {
    font-size: 10px;
    font-family: var(--mono);
    color: var(--accent2);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .step-title {
    font-size: 22px;
    font-weight: 700;
    margin-bottom: 6px;
    letter-spacing: -0.5px;
  }

  .step-desc {
    font-size: 13px;
    color: var(--text-dim);
    margin-bottom: 24px;
    line-height: 1.7;
  }

  /* Card options */
  .options {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 24px;
  }

  .option-btn {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 18px 20px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
    color: var(--text);
    font-family: inherit;
    font-size: 15px;
    font-weight: 500;
    text-align: left;
    transition: all 0.2s;
    width: 100%;
  }

  .option-btn:hover {
    border-color: var(--accent);
    background: var(--surface2);
    transform: translateX(4px);
  }

  .option-btn.selected {
    border-color: var(--accent);
    background: rgba(59,130,246,0.1);
  }

  .option-icon {
    font-size: 24px;
    min-width: 32px;
    text-align: center;
  }

  .option-text { flex: 1; }
  .option-title { display: block; }
  .option-sub { display: block; font-size: 12px; color: var(--text-dim); margin-top: 2px; }

  /* Yes/No checks */
  .checks {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 24px;
  }

  .check-item {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 16px 18px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
    transition: border-color 0.2s;
  }

  .check-item:hover { border-color: var(--border); }

  .check-label {
    flex: 1;
    font-size: 14px;
    line-height: 1.5;
  }

  .toggle-group {
    display: flex;
    gap: 6px;
  }

  .toggle-btn {
    padding: 5px 14px;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: var(--surface2);
    color: var(--text-dim);
    font-family: var(--mono);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .toggle-btn.yes.active { background: rgba(239,68,68,0.15); border-color: var(--red); color: var(--red); }
  .toggle-btn.no.active { background: rgba(16,185,129,0.1); border-color: var(--green); color: var(--green); }

  .check-item-wrap { display: flex; flex-direction: column; gap: 0; }

  .inline-warn {
    display: none;
    padding: 10px 16px;
    border-radius: 0 0 var(--radius-sm) var(--radius-sm);
    font-size: 12px;
    line-height: 1.6;
    font-weight: 500;
    margin-top: -2px;
    animation: fadeUp 0.2s ease both;
  }

  .inline-warn.level-yellow {
    display: block;
    background: var(--yellow-bg);
    border: 1px solid var(--yellow-border);
    border-top: none;
    color: var(--yellow);
  }

  .inline-warn.level-red {
    display: block;
    background: var(--red-bg);
    border: 1px solid var(--red-border);
    border-top: none;
    color: var(--red);
  }

  /* Self check */
  .selfcheck-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 24px;
  }

  .selfcheck-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all 0.2s;
  }

  .selfcheck-item.checked {
    border-color: var(--green);
    background: rgba(16,185,129,0.06);
  }

  .selfcheck-item .chk-box {
    width: 20px;
    height: 20px;
    border: 2px solid var(--border);
    border-radius: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s;
    font-size: 12px;
  }

  .selfcheck-item.checked .chk-box {
    background: var(--green);
    border-color: var(--green);
    color: #fff;
  }

  .selfcheck-item span:last-child { font-size: 14px; }

  /* Role select */
  .role-section { margin-bottom: 20px; }
  .role-section label {
    display: block;
    font-size: 12px;
    color: var(--text-dim);
    font-family: var(--mono);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .role-grid {
    display: grid;
    grid-template-columns: repeat(2,1fr);
    gap: 8px;
  }

  .role-btn {
    padding: 12px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: inherit;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.15s;
    text-align: center;
  }

  .role-btn:hover { border-color: var(--accent); }
  .role-btn.selected { border-color: var(--accent); background: rgba(59,130,246,0.1); color: var(--accent); }

  .dept-select {
    width: 100%;
    padding: 12px 16px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: inherit;
    font-size: 14px;
    appearance: none;
    cursor: pointer;
  }

  .dept-select:focus { outline: none; border-color: var(--accent); }
  .dept-select option { background: var(--surface); }

  /* Result */
  .result-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 18px;
    border-radius: 99px;
    font-weight: 700;
    font-size: 14px;
    font-family: var(--mono);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 20px;
  }

  .badge-green { background: var(--green-bg); border: 1px solid var(--green-border); color: var(--green); }
  .badge-yellow { background: var(--yellow-bg); border: 1px solid var(--yellow-border); color: var(--yellow); }
  .badge-red { background: var(--red-bg); border: 1px solid var(--red-border); color: var(--red); }

  .result-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 16px;
  }

  .result-card.green { border-color: var(--green-border); }
  .result-card.yellow { border-color: var(--yellow-border); }
  .result-card.red { border-color: var(--red-border); }

  .card-title {
    font-size: 12px;
    font-family: var(--mono);
    color: var(--text-dim);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-bottom: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .card-title::before {
    content: '';
    display: inline-block;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
  }

  .prompt-box {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 16px;
    font-size: 13px;
    line-height: 1.7;
    white-space: pre-wrap;
    font-family: var(--mono);
    color: #94a3b8;
    position: relative;
    margin-bottom: 12px;
  }

  .copy-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    background: var(--accent);
    border: none;
    border-radius: var(--radius-sm);
    color: #fff;
    font-family: inherit;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s;
  }

  .copy-btn:hover { background: #2563eb; }
  .copy-btn:active { transform: scale(0.97); }

  .anon-guide {
    background: var(--surface2);
    border-radius: var(--radius-sm);
    padding: 14px 16px;
  }

  .anon-row {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 6px 0;
    font-size: 13px;
    border-bottom: 1px solid var(--border);
  }

  .anon-row:last-child { border-bottom: none; }
  .anon-from { color: var(--text-dim); min-width: 140px; }
  .anon-arrow { color: var(--accent2); flex-shrink: 0; }
  .anon-to { color: var(--green); font-family: var(--mono); }

  .ng-list { display: flex; flex-direction: column; gap: 8px; }

  .ng-item {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: 13px;
    color: var(--text-dim);
    line-height: 1.5;
  }

  .ng-item::before {
    content: 'âœ•';
    color: var(--red);
    flex-shrink: 0;
    font-weight: 700;
    margin-top: 1px;
  }

  .checklist { display: flex; flex-direction: column; gap: 8px; }

  .checklist-item {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: 13px;
    line-height: 1.5;
  }

  .checklist-item::before {
    content: 'âœ“';
    color: var(--green);
    flex-shrink: 0;
    font-weight: 700;
    margin-top: 1px;
  }

  /* Buttons */
  .btn-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none;
    border-radius: var(--radius-sm);
    color: #fff;
    font-family: inherit;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: 12px;
  }

  .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }
  .btn-primary:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }

  .btn-secondary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 12px 20px;
    background: transparent;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text-dim);
    font-family: inherit;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .btn-secondary:hover { border-color: var(--text-dim); color: var(--text); }

  .btn-row {
    display: flex;
    gap: 10px;
    margin-top: 8px;
  }

  .btn-row .btn-secondary { flex: 1; }

  .btn-survey {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 16px;
    background: var(--surface);
    border: 1px solid var(--yellow-border);
    border-radius: var(--radius-sm);
    color: var(--yellow);
    font-family: inherit;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s;
    margin-bottom: 12px;
  }

  .btn-survey:hover { background: var(--yellow-bg); }

  .btn-reset {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    width: 100%;
    padding: 14px;
    background: transparent;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text-dim);
    font-family: inherit;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .btn-reset:hover { border-color: var(--accent); color: var(--accent); }

  /* Toast */
  .toast {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%) translateY(80px);
    background: var(--green);
    color: #fff;
    padding: 10px 20px;
    border-radius: 99px;
    font-size: 13px;
    font-weight: 600;
    z-index: 9999;
    transition: transform 0.3s cubic-bezier(0.4,0,0.2,1);
    white-space: nowrap;
  }

  .toast.show { transform: translateX(-50%) translateY(0); }

  /* Footer */
  footer {
    text-align: center;
    padding: 20px;
    font-size: 11px;
    color: var(--text-dim);
    border-top: 1px solid var(--border);
    background: rgba(10,15,30,0.8);
    position: relative;
    z-index: 1;
  }

  /* Survey step */
  .survey-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px 24px;
    text-align: center;
    margin-bottom: 16px;
  }

  .survey-icon { font-size: 40px; margin-bottom: 12px; }
  .survey-card h3 { font-size: 18px; font-weight: 700; margin-bottom: 8px; }
  .survey-card p { font-size: 13px; color: var(--text-dim); line-height: 1.7; margin-bottom: 20px; }

  @media (min-width: 600px) {
    .role-grid { grid-template-columns: repeat(4,1fr); }
    header { padding: 20px 32px; }
    main { padding: 32px 24px 100px; }
    .step-title { font-size: 26px; }
  }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <div class="header-title">AIä½¿ã£ã¦ã„ã„ï¼Ÿ 3ã¤ã®è³ªå•ã§åˆ¤æ–­</div>
    <div class="north-star">AIã¯äººã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã§ã¯ãªãã€åˆ¤æ–­ã¨æŒ‘æˆ¦ã‚’åŠ©ã‘ã‚‹ãŸã‚ã«ä½¿ã„ã¾ã™ã€‚<br>æœ€çµ‚åˆ¤æ–­ã¯äººé–“ãŒè¡Œã„ã¾ã™ã€‚</div>
  </div>
</header>

<main>
  <div class="progress-wrap">
    <div class="progress-labels">
      <span id="progressLabel">STEP 1 / 7</span>
      <span id="progressPct">14%</span>
    </div>
    <div class="progress-bar-outer">
      <div class="progress-bar-inner" id="progressBar" style="width:14%"></div>
    </div>
  </div>

  <!-- STEP 1: Mode -->
  <div class="step active" id="step1">
    <div class="step-label">STEP 01 â€” MODE</div>
    <div class="step-title">ä»Šä½•ã‚’ã—ãŸã„ã§ã™ã‹ï¼Ÿ</div>
    <div class="step-desc">AIã«ä½•ã‚’æ‰‹ä¼ã£ã¦ã»ã—ã„ã‹ã€ä¸€ç•ªè¿‘ã„ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</div>
    <div class="options" id="modeOptions">
      <button class="option-btn" data-value="analysis" onclick="selectOption('mode','analysis',this)">
        <span class="option-icon">ğŸ“Š</span>
        <span class="option-text">
          <span class="option-title">ãƒ‡ãƒ¼ã‚¿åˆ†æã—ãŸã„</span>
          <span class="option-sub">æ•°å€¤ãƒ»ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã«å‚¾å‘ã‚„æ”¹å–„ä»®èª¬ã‚’å‡ºã—ãŸã„</span>
        </span>
      </button>
      <button class="option-btn" data-value="thinking" onclick="selectOption('mode','thinking',this)">
        <span class="option-icon">ğŸ§ </span>
        <span class="option-text">
          <span class="option-title">è€ƒãˆã‚’æ•´ç†ã—ãŸã„</span>
          <span class="option-sub">èª²é¡Œãƒ»è«–ç‚¹ãƒ»ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è¨€èªåŒ–ãƒ»æ§‹é€ åŒ–ã—ãŸã„</span>
        </span>
      </button>
      <button class="option-btn" data-value="decision" onclick="selectOption('mode','decision',this)">
        <span class="option-icon">âš–ï¸</span>
        <span class="option-text">
          <span class="option-title">æ„æ€æ±ºå®šã®å‚è€ƒã«ã—ãŸã„</span>
          <span class="option-sub">é¸æŠè‚¢ãƒ»ãƒªã‚¹ã‚¯ãƒ»æ¨å¥¨æ¡ˆã‚’æ•´ç†ã—ãŸã„</span>
        </span>
      </button>
      <button class="option-btn" data-value="thinking" onclick="selectOption('mode','thinking',this)">
        <span class="option-icon">â“</span>
        <span class="option-text">
          <span class="option-title">ã‚ˆãåˆ†ã‹ã‚‰ãªã„</span>
          <span class="option-sub">â†’ æ€è€ƒæ•´ç†ã¨ã—ã¦æ‰±ã„ã¾ã™</span>
        </span>
      </button>
    </div>
    <button class="btn-primary" id="step1Next" onclick="goNext()" disabled>æ¬¡ã¸ â†’</button>
  </div>

  <!-- STEP 2: Input type -->
  <div class="step" id="step2">
    <div class="step-label">STEP 02 â€” INPUT</div>
    <div class="step-title">å…¥åŠ›ã™ã‚‹æƒ…å ±ã®ç¨®é¡ã¯ï¼Ÿ</div>
    <div class="step-desc">AIã«æ¸¡ã™å†…å®¹ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚</div>
    <div class="options">
      <button class="option-btn" data-value="data" onclick="selectOption('input','data',this)">
        <span class="option-icon">ğŸ“‹</span>
        <span class="option-text">
          <span class="option-title">ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã†</span>
          <span class="option-sub">CSVãƒ‡ãƒ¼ã‚¿ã€æ•°å€¤ã€é›†è¨ˆè¡¨ãªã©</span>
        </span>
      </button>
      <button class="option-btn" data-value="text" onclick="selectOption('input','text',this)">
        <span class="option-icon">âœï¸</span>
        <span class="option-text">
          <span class="option-title">æ–‡ç« ã®ã¿</span>
          <span class="option-sub">ãƒ†ã‚­ã‚¹ãƒˆã€çŠ¶æ³èª¬æ˜ã€ã‚¢ã‚¤ãƒ‡ã‚¢ã®ã¿</span>
        </span>
      </button>
      <button class="option-btn" data-value="unknown" onclick="selectOption('input','unknown',this)">
        <span class="option-icon">ğŸ”²</span>
        <span class="option-text">
          <span class="option-title">æœªå®š</span>
          <span class="option-sub">ã¾ã æ±ºã¾ã£ã¦ã„ãªã„</span>
        </span>
      </button>
    </div>
    <div class="btn-row">
      <button class="btn-secondary" onclick="goBack()">â† æˆ»ã‚‹</button>
      <button class="btn-primary" id="step2Next" onclick="goNext()" disabled style="margin-bottom:0;flex:2">æ¬¡ã¸ â†’</button>
    </div>
  </div>

  <!-- STEP 3: Security -->
  <div class="step" id="step3">
    <div class="step-label">STEP 03 â€” SECURITY</div>
    <div class="step-title">å«ã¾ã‚Œã‚‹æƒ…å ±ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</div>
    <div class="step-desc">å½“ã¦ã¯ã¾ã‚‹ã‚‚ã®ã‚’ YES / NO ã§é¸ã‚“ã§ãã ã•ã„ã€‚å…¨éƒ¨NOãªã‚‰å®‰å…¨ã§ã™ã€‚</div>
    <div class="checks">
      <div class="check-item-wrap">
        <div class="check-item">
          <div class="check-label">å€‹äººåãƒ»å€‹äººã‚’ç‰¹å®šã§ãã‚‹æƒ…å ±ãŒå«ã¾ã‚Œã‚‹</div>
          <div class="toggle-group">
            <button class="toggle-btn yes" data-key="personalName" onclick="toggleCheck('personalName','yes',this)">YES</button>
            <button class="toggle-btn no" data-key="personalName" onclick="toggleCheck('personalName','no',this)">NO</button>
          </div>
        </div>
        <div class="inline-warn" id="warn-personalName"></div>
      </div>
      <div class="check-item-wrap">
        <div class="check-item">
          <div class="check-label">æœªå…¬é–‹ç¤¾å†…æƒ…å ±ãƒ»è²¡å‹™æƒ…å ±ãŒå«ã¾ã‚Œã‚‹</div>
          <div class="toggle-group">
            <button class="toggle-btn yes" data-key="financialInfo" onclick="toggleCheck('financialInfo','yes',this)">YES</button>
            <button class="toggle-btn no" data-key="financialInfo" onclick="toggleCheck('financialInfo','no',this)">NO</button>
          </div>
        </div>
        <div class="inline-warn" id="warn-financialInfo"></div>
      </div>
      <div class="check-item-wrap">
        <div class="check-item">
          <div class="check-label">å¥‘ç´„å†…å®¹ãƒ»é¡§å®¢åãŒå«ã¾ã‚Œã‚‹</div>
          <div class="toggle-group">
            <button class="toggle-btn yes" data-key="contractInfo" onclick="toggleCheck('contractInfo','yes',this)">YES</button>
            <button class="toggle-btn no" data-key="contractInfo" onclick="toggleCheck('contractInfo','no',this)">NO</button>
          </div>
        </div>
        <div class="inline-warn" id="warn-contractInfo"></div>
      </div>
      <div class="check-item-wrap">
        <div class="check-item">
          <div class="check-label">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ»APIã‚­ãƒ¼ãŒå«ã¾ã‚Œã‚‹</div>
          <div class="toggle-group">
            <button class="toggle-btn yes" data-key="apiKey" onclick="toggleCheck('apiKey','yes',this)">YES</button>
            <button class="toggle-btn no" data-key="apiKey" onclick="toggleCheck('apiKey','no',this)">NO</button>
          </div>
        </div>
        <div class="inline-warn" id="warn-apiKey"></div>
      </div>
    </div>
    <div class="btn-row">
      <button class="btn-secondary" onclick="goBack()">â† æˆ»ã‚‹</button>
      <button class="btn-primary" id="step3Next" onclick="goNext()" disabled style="margin-bottom:0;flex:2">æ¬¡ã¸ â†’</button>
    </div>
  </div>

  <!-- STEP 4: Self check -->
  <div class="step" id="step4">
    <div class="step-label">STEP 04 â€” SELF CHECK</div>
    <div class="step-title" id="selfcheckTitle">è‡ªå·±ãƒã‚§ãƒƒã‚¯</div>
    <div class="step-desc">3ã¤ã™ã¹ã¦ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚ŒãŸã‚‰æ¬¡ã¸é€²ã‚ã¾ã™ã€‚</div>
    <div class="selfcheck-list" id="selfcheckList"></div>
    <div class="btn-row">
      <button class="btn-secondary" onclick="goBack()">â† æˆ»ã‚‹</button>
      <button class="btn-primary" id="step4Next" onclick="goNext()" disabled style="margin-bottom:0;flex:2">æ¬¡ã¸ â†’</button>
    </div>
  </div>

  <!-- STEP 5: Role -->
  <div class="step" id="step5">
    <div class="step-label">STEP 05 â€” ROLE</div>
    <div class="step-title">å½¹å‰²ãƒ»éƒ¨ç½²ã‚’æ•™ãˆã¦ãã ã•ã„</div>
    <div class="step-desc">å€‹äººç‰¹å®šã¯ã—ã¾ã›ã‚“ã€‚é›†è¨ˆãƒ»æ”¹å–„ç›®çš„ã®ã¿ã§ã™ã€‚</div>
    <div class="role-section">
      <label>å½¹å‰²ï¼ˆå¿…é ˆï¼‰</label>
      <div class="role-grid" id="roleGrid">
        <button class="role-btn" onclick="selectRole('å¹¹éƒ¨',this)">å¹¹éƒ¨</button>
        <button class="role-btn" onclick="selectRole('ç®¡ç†è·',this)">ç®¡ç†è·</button>
        <button class="role-btn" onclick="selectRole('ç¾å ´',this)">ç¾å ´</button>
        <button class="role-btn" onclick="selectRole('ãã®ä»–',this)">ãã®ä»–</button>
      </div>
    </div>
    <div class="role-section">
      <label>éƒ¨ç½²ï¼ˆä»»æ„ï¼‰</label>
      <select class="dept-select" id="deptSelect" onchange="state.dept=this.value">
        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
        <option>å¤–å•†</option>
        <option>é…è»Š</option>
        <option>CS</option>
        <option>æ•™è‚²</option>
        <option>ä¼ç”»</option>
        <option>IT</option>
        <option>ãã®ä»–</option>
      </select>
    </div>
    <div class="btn-row">
      <button class="btn-secondary" onclick="goBack()">â† æˆ»ã‚‹</button>
      <button class="btn-primary" id="step5Next" onclick="goNext()" disabled style="margin-bottom:0;flex:2">æ¬¡ã¸ â†’</button>
    </div>
  </div>

  <!-- STEP 6: Result -->
  <div class="step" id="step6">
    <div class="step-label">STEP 06 â€” RESULT</div>
    <div class="step-title">è¨ºæ–­çµæœ</div>
    <div id="resultContent"></div>
    <button class="btn-primary" onclick="goNext()">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¸ â†’</button>
    <button class="btn-reset" onclick="resetAll()">â†º æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
  </div>

  <!-- STEP 7: Survey -->
  <div class="step" id="step7">
    <div class="step-label">STEP 07 â€” FEEDBACK</div>
    <div class="step-title">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã”å”åŠ›ã‚’</div>
    <div class="survey-card">
      <div class="survey-icon">ğŸ“</div>
      <h3>30ç§’ã§AIåˆ©ç”¨æ”¹å–„ã«è²¢çŒ®ã§ãã¾ã™</h3>
      <p>ã‚ãªãŸã®åˆ©ç”¨çŠ¶æ³ã‚’æ•™ãˆã¦ã„ãŸã ãã“ã¨ã§ã€ç¤¾å†…AIæ´»ç”¨ã‚¬ã‚¤ãƒ‰ã®æ”¹å–„ã«å½¹ç«‹ã¦ã¾ã™ã€‚åŒ¿åã§å›ç­”ã§ãã¾ã™ã€‚</p>
      <a class="btn-survey" href="https://example.com/zoho-survey" target="_blank" rel="noopener">
        ğŸ“ 30ç§’ã§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ã‚‹
      </a>
    </div>
    <button class="btn-reset" onclick="resetAll()">â†º æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
  </div>
</main>

<footer>
  ã“ã®ãƒšãƒ¼ã‚¸ã¯ç¤¾å†…åˆ©ç”¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚å€‹äººæƒ…å ±ãƒ»æœªå…¬é–‹æƒ…å ±ãƒ»èªè¨¼æƒ…å ±ã¯å…¥åŠ›ã—ãªã„ã§ãã ã•ã„ã€‚
</footer>

<div class="toast" id="toast">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ âœ“</div>

<script>
const state = {
  mode: null,
  input: null,
  security: { personalName: null, financialInfo: null, contractInfo: null, apiKey: null },
  selfChecks: [false,false,false],
  role: null,
  dept: '',
  currentStep: 1
};

const totalSteps = 7;

const selfCheckQuestions = {
  analysis: [
    'ãƒ‡ãƒ¼ã‚¿ã¯åŒ¿ååŒ–æ¸ˆã¿ã€ã¾ãŸã¯å›ºæœ‰åè©ã‚’é™¤å»æ¸ˆã¿',
    'åˆ†æç›®çš„ã‚’ä¸€æ–‡ã§èª¬æ˜ã§ãã‚‹',
    'AIã®å‡ºåŠ›çµæœã‚’è‡ªåˆ†ã§æ¤œè¨¼ã§ãã‚‹'
  ],
  thinking: [
    'å›ºæœ‰åè©ãªã—ã§çŠ¶æ³ã‚’èª¬æ˜ã§ãã‚‹',
    'æ­£è§£ã‚’æ±‚ã‚ã‚‹ã®ã§ã¯ãªãã€æ•´ç†ãŒç›®çš„',
    'è«–ç‚¹ã¯3ã¤ä»¥å†…ã«çµã‚Œã¦ã„ã‚‹'
  ],
  decision: [
    'åˆ¤æ–­ãƒ†ãƒ¼ãƒãŒæ˜ç¢ºã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹',
    'åˆ¶ç´„æ¡ä»¶ï¼ˆäºˆç®—ãƒ»æœŸé–“ãƒ»é–¢ä¿‚è€…ï¼‰ãŒæ•´ç†ã•ã‚Œã¦ã„ã‚‹',
    'æœ€çµ‚çš„ãªåˆ¤æ–­è²¬ä»»ã¯äººé–“ãŒæŒã¤ã“ã¨ã‚’ç†è§£ã—ã¦ã„ã‚‹'
  ]
};

const selfCheckTitles = {
  analysis: 'ã€åˆ†æãƒ¢ãƒ¼ãƒ‰ã€‘è‡ªå·±ãƒã‚§ãƒƒã‚¯',
  thinking: 'ã€æ€è€ƒãƒ¢ãƒ¼ãƒ‰ã€‘è‡ªå·±ãƒã‚§ãƒƒã‚¯',
  decision: 'ã€æ„æ€æ±ºå®šãƒ¢ãƒ¼ãƒ‰ã€‘è‡ªå·±ãƒã‚§ãƒƒã‚¯'
};

const prompts = {
  analysis: `ä»¥ä¸‹ã®åŒ¿ååŒ–æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ãã ã•ã„ï¼š

ãƒ»ä¸»è¦å‚¾å‘
ãƒ»é »å‡ºãƒ†ãƒ¼ãƒ
ãƒ»æ”¹å–„ä»®èª¬ï¼ˆå„ªå…ˆé †ä½ï¼‰

ãƒ‡ãƒ¼ã‚¿ï¼š
<<<å…¥åŠ›>>>`,
  thinking: `æ¬¡ã®èª²é¡Œã«ã¤ã„ã¦ä»¥ä¸‹ã®æ§‹é€ ã§æ•´ç†ã—ã¦ãã ã•ã„ï¼š

1. å‰æ
2. è«–ç‚¹
3. ä»®èª¬
4. åè¨¼
5. æ¬¡ã®ä¸€æ‰‹

ãƒ†ãƒ¼ãƒï¼š
<<<å…¥åŠ›>>>`,
  decision: `æ¬¡ã®æ„æ€æ±ºå®šã«ã¤ã„ã¦æ•´ç†ã—ã¦ãã ã•ã„ï¼š

ãƒ»é¸æŠè‚¢
ãƒ»å„é¸æŠè‚¢ã®ãƒ¡ãƒªãƒƒãƒˆ
ãƒ»å„é¸æŠè‚¢ã®ãƒªã‚¹ã‚¯
ãƒ»ä¸è¶³ã—ã¦ã„ã‚‹æƒ…å ±
ãƒ»æ¨å¥¨æ¡ˆ

ãƒ†ãƒ¼ãƒï¼š
<<<å…¥åŠ›>>>`
};

const modeLabels = { analysis:'ãƒ‡ãƒ¼ã‚¿åˆ†æ', thinking:'æ€è€ƒæ•´ç†', decision:'æ„æ€æ±ºå®š' };

function updateProgress() {
  const pct = Math.round((state.currentStep / totalSteps) * 100);
  document.getElementById('progressBar').style.width = pct + '%';
  document.getElementById('progressLabel').textContent = `STEP ${state.currentStep} / ${totalSteps}`;
  document.getElementById('progressPct').textContent = pct + '%';
}

function showStep(n) {
  document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
  document.getElementById('step' + n).classList.add('active');
  state.currentStep = n;
  updateProgress();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function goNext() {
  if (state.currentStep === 3) {
    renderSelfCheck();
  }
  if (state.currentStep === 5) {
    renderResult();
  }
  showStep(state.currentStep + 1);
}

function goBack() {
  if (state.currentStep > 1) showStep(state.currentStep - 1);
}

function selectOption(key, value, btn) {
  state[key] = value;
  const parent = btn.closest('.options');
  parent.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  const nextBtn = document.getElementById('step' + state.currentStep + 'Next');
  if (nextBtn) nextBtn.disabled = false;

  if (key === 'mode') {
    state.selfChecks = [false, false, false];
  }
}

const securityWarnings = {
  personalName: {
    yes: { level: 'yellow', msg: 'âš ï¸ å€‹äººã‚’ç‰¹å®šã§ãã‚‹æƒ…å ±ã§ã™ã€‚åˆ¤å®šãŒ YELLOW ã«ãªã‚Šã¾ã™ã€‚å¿…ãšåŒ¿ååŒ–ï¼ˆä¾‹ï¼šå±±ç”°å¤ªéƒ â†’ Staff_Aï¼‰ã—ã¦ã‹ã‚‰å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚' },
    no: null
  },
  financialInfo: {
    yes: { level: 'red', msg: 'ğŸš« æœªå…¬é–‹è²¡å‹™æƒ…å ±ã¯å¤–éƒ¨AIã¸ã®å…¥åŠ›ç¦æ­¢ã§ã™ã€‚åˆ¤å®šãŒ RED ã«ãªã‚Šã¾ã™ã€‚æƒ…å ±ã‚’æŠ½è±¡åŒ–ã™ã‚‹ã‹ã€ç¤¾å†…æ‹…å½“è€…ã«ç›¸è«‡ã—ã¦ãã ã•ã„ã€‚' },
    no: null
  },
  contractInfo: {
    yes: { level: 'red', msg: 'ğŸš« å¥‘ç´„ãƒ»é¡§å®¢æƒ…å ±ã¯å¤–éƒ¨AIã¸ã®å…¥åŠ›ç¦æ­¢ã§ã™ã€‚åˆ¤å®šãŒ RED ã«ãªã‚Šã¾ã™ã€‚é¡§å®¢åã‚’ã€Œé¡§å®¢Bã€ã«ç½®ãæ›ãˆã‚‹ãªã©å®Œå…¨åŒ¿ååŒ–ãŒå¿…è¦ã§ã™ã€‚' },
    no: null
  },
  apiKey: {
    yes: { level: 'red', msg: 'ğŸš¨ çµ¶å¯¾ã«å…¥åŠ›ã—ãªã„ã§ãã ã•ã„ï¼APIã‚­ãƒ¼ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å³åº§ã«åˆ¤å®š RED ã«ãªã‚Šã¾ã™ã€‚æ¼æ´©ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚å…¥åŠ›ã‚’ã‚„ã‚ã¦ NO ã«æˆ»ã—ã¦ãã ã•ã„ã€‚' },
    no: null
  }
};

function toggleCheck(key, val, btn) {
  state.security[key] = val;
  const group = btn.closest('.toggle-group');
  group.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');

  const warnEl = document.getElementById('warn-' + key);
  if (warnEl) {
    const warn = securityWarnings[key][val];
    if (warn) {
      warnEl.textContent = warn.msg;
      warnEl.className = 'inline-warn level-' + warn.level;
    } else {
      warnEl.textContent = '';
      warnEl.className = 'inline-warn';
    }
  }

  checkSecurityComplete();
}

function checkSecurityComplete() {
  const all = Object.values(state.security).every(v => v !== null);
  document.getElementById('step3Next').disabled = !all;
}

function renderSelfCheck() {
  const mode = state.mode || 'thinking';
  const qs = selfCheckQuestions[mode];
  const title = selfCheckTitles[mode];
  document.getElementById('selfcheckTitle').textContent = title;
  state.selfChecks = [false, false, false];
  const list = document.getElementById('selfcheckList');
  list.innerHTML = '';
  qs.forEach((q, i) => {
    const item = document.createElement('div');
    item.className = 'selfcheck-item';
    item.innerHTML = `<div class="chk-box"></div><span>${q}</span>`;
    item.onclick = () => {
      state.selfChecks[i] = !state.selfChecks[i];
      item.classList.toggle('checked', state.selfChecks[i]);
      item.querySelector('.chk-box').textContent = state.selfChecks[i] ? 'âœ“' : '';
      document.getElementById('step4Next').disabled = !state.selfChecks.every(Boolean);
    };
    list.appendChild(item);
  });
  document.getElementById('step4Next').disabled = true;
}

function selectRole(role, btn) {
  state.role = role;
  document.querySelectorAll('#roleGrid .role-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  document.getElementById('step5Next').disabled = false;
}

function calcSecurityLevel() {
  const s = state.security;
  if (s.apiKey === 'yes') return 'RED';
  if (s.financialInfo === 'yes' || s.contractInfo === 'yes') return 'RED';
  if (s.personalName === 'yes') return 'YELLOW';
  return 'GREEN';
}

function renderResult() {
  const level = calcSecurityLevel();
  const mode = state.mode || 'thinking';
  const prompt = prompts[mode];
  const modeLabel = modeLabels[mode];

  let badgeClass, badgeIcon, statusTitle, statusDesc;
  if (level === 'GREEN') {
    badgeClass = 'badge-green'; badgeIcon = 'ğŸŸ¢';
    statusTitle = 'é€šå¸¸åˆ©ç”¨OK';
    statusDesc = 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®å•é¡Œã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚æ¨å¥¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ãã®ã¾ã¾æ´»ç”¨ã§ãã¾ã™ã€‚';
  } else if (level === 'YELLOW') {
    badgeClass = 'badge-yellow'; badgeIcon = 'ğŸŸ¡';
    statusTitle = 'åŒ¿ååŒ–ã—ã¦åˆ©ç”¨';
    statusDesc = 'å€‹äººã‚’ç‰¹å®šã§ãã‚‹æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚å¿…ãšåŒ¿ååŒ–å‡¦ç†ã‚’è¡Œã£ã¦ã‹ã‚‰AIã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
  } else {
    badgeClass = 'badge-red'; badgeIcon = 'ğŸ”´';
    statusTitle = 'å¤–éƒ¨AIå…¥åŠ›ä¸å¯';
    statusDesc = 'æ©Ÿå¯†æ€§ã®é«˜ã„æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚å¤–éƒ¨AIã«ç›´æ¥å…¥åŠ›ã›ãšã€æƒ…å ±ã‚’æŠ½è±¡åŒ–ã—ãŸä¸Šã§ç¤¾å†…æ‹…å½“è€…ã«ç›¸è«‡ã—ã¦ãã ã•ã„ã€‚';
  }

  const checkItems = level === 'GREEN' ? [
    'ãƒ‡ãƒ¼ã‚¿ãƒ»æƒ…å ±ã®åŒ¿ååŒ–ã‚’ç¢ºèªã—ãŸ',
    'æ¨å¥¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹',
    'AIå‡ºåŠ›ã‚’éµœå‘‘ã¿ã«ã›ãšè‡ªåˆ†ã§æ¤œè¨¼ã™ã‚‹',
    'æœ€çµ‚åˆ¤æ–­ã¯è‡ªåˆ†ã§è¡Œã†'
  ] : level === 'YELLOW' ? [
    'å€‹äººå â†’ RoleIDã«å¤‰æ›ã™ã‚‹',
    'ä¼šç¤¾åãƒ»é¡§å®¢å â†’ æ¥­ç•Œåãƒ»åŒ¿åã«å¤‰æ›ã™ã‚‹',
    'é‡‘é¡ â†’ ãƒ¬ãƒ³ã‚¸è¡¨ç¾ã«å¤‰æ›ã™ã‚‹',
    'åŒ¿ååŒ–å¾Œã«æ¨å¥¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹',
    'AIå‡ºåŠ›ã‚’è‡ªåˆ†ã§æ¤œè¨¼ã™ã‚‹'
  ] : [
    'å¤–éƒ¨AIã¸ã®ç›´æ¥å…¥åŠ›ã‚’ç¦æ­¢',
    'æƒ…å ±ã‚’æŠ½è±¡åŒ–ãƒ»æ¦‚å¿µåŒ–ã™ã‚‹',
    'å¿…è¦ãªå ´åˆã¯ç¤¾å†…ITãƒ»æ‹…å½“è€…ã«ç›¸è«‡',
    'ã©ã†ã—ã¦ã‚‚ä½¿ã„ãŸã„å ´åˆã¯å®Œå…¨åŒ¿ååŒ–ã—ã¦ã‹ã‚‰å†è¨ºæ–­'
  ];

  const ngItems = level === 'GREEN' ? [
    'å€‹äººåãƒ»é¡§å®¢åã‚’å«ã‚“ã ã¾ã¾ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«è²¼ã‚Šä»˜ã‘ã‚‹',
    'APIã‚­ãƒ¼ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹',
    'AIå‡ºåŠ›ã‚’æ¤œè¨¼ãªã—ã«ãã®ã¾ã¾å ±å‘Šæ›¸ã«ä½¿ã†'
  ] : level === 'YELLOW' ? [
    'å€‹äººåã‚’ãã®ã¾ã¾å…¥åŠ›ã™ã‚‹',
    'é¡§å®¢åãƒ»å¥‘ç´„å†…å®¹ã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã‚‹',
    'åŒ¿ååŒ–å‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹'
  ] : [
    'æœªå…¬é–‹è²¡å‹™æƒ…å ±ã‚’ãã®ã¾ã¾å…¥åŠ›ã™ã‚‹',
    'é¡§å®¢åãƒ»å¥‘ç´„æ›¸å†…å®¹ã‚’AIã«é€ä¿¡ã™ã‚‹',
    'APIã‚­ãƒ¼ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å«ã‚ã‚‹',
    'ã“ã®æƒ…å ±ã‚’ä½¿ã£ãŸã¾ã¾ä»–ã®AIã‚µãƒ¼ãƒ“ã‚¹ã§è©¦ã™'
  ];

  const showAnon = level !== 'GREEN';
  const showPrompt = level !== 'RED';

  let html = `
    <div class="result-badge ${badgeClass}">${badgeIcon} ${statusTitle}</div>
    <div class="result-card ${level.toLowerCase()}">
      <div class="card-title" style="color:var(--accent2)">è¨ºæ–­ã‚µãƒãƒªãƒ¼</div>
      <p style="font-size:14px;color:var(--text-dim);line-height:1.7;margin-bottom:8px">${statusDesc}</p>
      <p style="font-size:13px;color:var(--text-dim)">ãƒ¢ãƒ¼ãƒ‰ï¼š<strong style="color:var(--text)">${modeLabel}</strong> ï¼ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼š<strong style="color:${level==='GREEN'?'var(--green)':level==='YELLOW'?'var(--yellow)':'var(--red)'}">${level}</strong></p>
    </div>

    <div class="result-card">
      <div class="card-title" style="color:var(--green)">ã‚„ã‚‹ã“ã¨ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</div>
      <div class="checklist">${checkItems.map(i=>`<div class="checklist-item">${i}</div>`).join('')}</div>
    </div>
  `;

  if (showAnon) {
    html += `
      <div class="result-card">
        <div class="card-title" style="color:var(--yellow)">åŒ¿ååŒ–ã‚¬ã‚¤ãƒ‰ï¼ˆå¿…é ˆï¼‰</div>
        <div class="anon-guide">
          <div class="anon-row"><span class="anon-from">å±±ç”°å¤ªéƒï¼ˆå€‹äººåï¼‰</span><span class="anon-arrow">â†’</span><span class="anon-to">Staff_A</span></div>
          <div class="anon-row"><span class="anon-from">ã€‡ã€‡èˆªç©ºï¼ˆä¼šç¤¾åï¼‰</span><span class="anon-arrow">â†’</span><span class="anon-to">èˆªç©ºä¼šç¤¾A</span></div>
          <div class="anon-row"><span class="anon-from">é¡§å®¢å</span><span class="anon-arrow">â†’</span><span class="anon-to">é¡§å®¢B</span></div>
          <div class="anon-row"><span class="anon-from">500ä¸‡å††ï¼ˆé‡‘é¡ï¼‰</span><span class="anon-arrow">â†’</span><span class="anon-to">300ã€œ700ä¸‡å††</span></div>
          <div class="anon-row"><span class="anon-from">ç¾½ç”°ç©ºæ¸¯ï¼ˆåœ°åï¼‰</span><span class="anon-arrow">â†’</span><span class="anon-to">éƒ½å¸‚ç©ºæ¸¯</span></div>
        </div>
      </div>
    `;
  }

  if (showPrompt) {
    html += `
      <div class="result-card">
        <div class="card-title" style="color:var(--accent)">æ¨å¥¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆã‚³ãƒ”ãƒ¼å¯ï¼‰</div>
        <div class="prompt-box" id="promptBox">${prompt}</div>
        <button class="copy-btn" onclick="copyPrompt()">ğŸ“‹ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
      </div>
    `;
  }

  html += `
    <div class="result-card">
      <div class="card-title" style="color:var(--red)">NGä¾‹</div>
      <div class="ng-list">${ngItems.map(i=>`<div class="ng-item">${i}</div>`).join('')}</div>
    </div>
  `;

  document.getElementById('resultContent').innerHTML = html;
}

function copyPrompt() {
  const box = document.getElementById('promptBox');
  if (!box) return;
  const text = box.textContent;
  navigator.clipboard.writeText(text).then(() => showToast());
}

function showToast() {
  const t = document.getElementById('toast');
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

function resetAll() {
  state.mode = null; state.input = null;
  state.security = { personalName:null, financialInfo:null, contractInfo:null, apiKey:null };
  state.selfChecks = [false,false,false];
  state.role = null; state.dept = '';

  document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
  document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.inline-warn').forEach(w => { w.textContent = ''; w.className = 'inline-warn'; });
  document.querySelectorAll('.role-btn').forEach(b => b.classList.remove('selected'));
  document.getElementById('deptSelect').value = '';
  document.getElementById('step1Next').disabled = true;
  document.getElementById('step2Next').disabled = true;
  document.getElementById('step3Next').disabled = true;
  document.getElementById('step5Next').disabled = true;
  document.getElementById('resultContent').innerHTML = '';

  showStep(1);
}

// Init
updateProgress();
</script>
</body>
</html>
